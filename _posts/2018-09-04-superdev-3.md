---
title: "Super Dev 3"
header:
  overlay_image: /assets/images/unsplash-image-1.jpg
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
  cta_url: "https://unsplash.com"
date: 2018-09-04 22:11:40 -0400
categories: super developer
---

<ol start="3">
  <li>데이터베이스에서 인덱스를 달면 좋은 점은 무엇인가? 그럼 왜 모든 컬럼에 인덱스를 달지 않는가? 멀티 컬럼 인덱스와 레인지 쿼리는 무엇인가?</li>
</ol>

- 데이터베이스 인덱스의 장점

테이블을 만들때 인덱스를 사용하기 위해서는, 인덱스를 실제 한 컬럼으로 만들어야 한다. 그래서 인덱스의 존재를 모를 경우, 인덱스를 기본적으로 제공하지 않는데, 이는 뒤에 나올 두 번 째 질문의 답과 비슷하기 때문에 두 번 째 질문에서 알아보기로 하겠다.

인덱스의 장점은 검색 속도(select)에 있다. 그리고 이러한 장점으로 인하여 시스템의 부하가 줄고 성능 향상이 이루어진다. 

구체적으로 말하자면 인덱스는 트리구조를 이용하기 때문에, 검색 속도가 빠르다고 할 수 있다.

- 그런데 왜 모든 컬럼에 인덱스를 달지 않는가?

우선, 인덱스는 트리구조로 데이터의 추가, 수정, 삭제에 있어서는 풀 테이블 스캔보다 느리다. 트리구조라서 무조건 다 좋은 것은 아니고, 데이터 검색에서 큰 이점을 지닌 자료구조이기 때문에 적은 데이터만 있는 테이블에 대해서는 인덱스를 사용하는 것이 낭비이다.

이 질문은 모든 컬럼에 대해서 모두 인덱스 컬럼을 추가시키는 것이 좋지 않겠냐는 질문으로 이해되는데, 당연히 좋지 않다. 한 컬럼에 대해서 트리를 만드는 것도 낭비가 있었다. 그런데 모든 컬럼에 대해서 트리를 만들어 내는 것은, 매우 큰 낭비이고, 특히 카디널리티가 작은 컬럼들은 트리 구조로 만들 필요가 전혀 없다. 가령 성별에 대해서 인덱스를 사용한다면, ‘남’, ‘여’의 트리가 만들어질텐데, 이렇게 만들어진 트리는 풀 테이블 스캔과 별 다를 바가 없어보인다.

- 멀티컬럼 인덱스란 무엇인가?

멀티컬럼 인덱스는 필드를 2개 이상 묶어 놓은 인덱스를 의미한다. 이경우엔 데이터가 들어올 때, 여러 데이터를 인덱스로 묶어서 트리에 저장한다. WHERE문 안에서 특정한 두 가지 이상의 항목을 자주 AND 하는 테이블에 멀티컬럼 인덱스를 사용한다. 멀티컬럼 인덱스의 한 컬럼만을 검색하는 경우(AND가 없는 경우)에는 인덱스가 동작하지 않는다.

- 레인지 쿼리란 무엇인가?

이 질문이 인덱스 레인지 스캔을 묻는 줄 알고 정리를 하고 있었다.

> 인덱스 레인지 스캔은 검색할 인덱스의 범위가 정해졌을 때에 사용하는 방식이다. 트리구조는 바로 다음 노드를 찾는 것이 어려울 수 있고, 단순한 트리 구조에서는 레인지 쿼리를 이용하면 효율적이지 않을 수 있다. 그래서 예측인데, B+ 트리 등을 이용하여 바로 다음 노드를 가리키는 구조를 가진 경우에만 레인지 쿼리를 이용하는… 

다른 얘기인 것 같아서, 영문 wiki를 참고하였다.

> A range query is a common database operation that retrieves all records where some value is between an upper and lower boundary.

단순하게 예를 들면 이런 쿼리이다. 

SELECT * FROM employees WHERE age BETWEEN 20 AND 30;
